#!/bin/bash

echo "๐ ุฑุงูโุงูุฏุงุฒ ุชุชุฑุงุดุงูพ - ูุณุฎู ุชุณุช"
echo "=================================="

# ุชููู ุณุฑูุณโูุง ูุจู
echo "๐ ุชููู ุณุฑูุณโูุง ูุจู..."
pkill -f "node.*simple-proxy" 2>/dev/null
pkill -f "python3 -m http.server" 2>/dev/null
sleep 2

# ฺฉูพ ูุงู ุชุณุช ุจู ุฌุง ูุงู ุงุตู
echo "๐ ุชูุธู ูุงูโูุง..."
cp index-test.html index.html 2>/dev/null || echo "โ๏ธ ูุงู index-test.html ููุฌูุฏ ูุณุชุ ุงุฒ ูุงู ุงุตู ุงุณุชูุงุฏู ูโุดูุฏ"

# ุฑุงูโุงูุฏุงุฒ ูพุฑูฺฉุณ
echo "๐ง ุฑุงูโุงูุฏุงุฒ ูพุฑูฺฉุณ..."
node simple-proxy.js &
PROXY_PID=$!
echo "๐ PID ูพุฑูฺฉุณ: $PROXY_PID"

# ููุชุธุฑ ุฑุงูโุงูุฏุงุฒ ูพุฑูฺฉุณ
sleep 3

# ุชุณุช ูพุฑูฺฉุณ
echo "๐ ุชุณุช ูพุฑูฺฉุณ..."
if curl -s http://localhost:3003 > /dev/null; then
    echo "โ ูพุฑูฺฉุณ ูุนุงู ุดุฏ"
else
    echo "โ ูุดฺฉู ุฏุฑ ูพุฑูฺฉุณ"
    exit 1
fi

# ุฑุงูโุงูุฏุงุฒ ุณุฑูุฑ
echo "๐ ุฑุงูโุงูุฏุงุฒ ุณุฑูุฑ ูุจ..."
python3 -m http.server 8000 &
SERVER_PID=$!
echo "๐ PID ุณุฑูุฑ: $SERVER_PID"

sleep 2

echo ""
echo "๐ ุณุณุชู ุจุง ููููุช ุฑุงูโุงูุฏุงุฒ ุดุฏ!"
echo "=================================="
echo ""
echo "๐ ุขุฏุฑุณ ุฏุณุชุฑุณ: http://localhost:8000"
echo ""
echo "๐ ุฑุงูููุง ุงุณุชูุงุฏู:"
echo "   1. ูุฑูุฑฺฏุฑ ุฑู ุจุงุฒ ฺฉู"
echo "   2. ุตุจุฑ ฺฉู ุชุง 'โ ุงุชุตุงู ุจุฑูุฑุงุฑ ุดุฏ' ุฑู ุจุจู"
echo "   3. ุฑู ุฏฺฉูู '๐ ุงุฌุฑุง ุฌุณุชุฌู (ูุณุฎู ุชุณุช)' ฺฉูฺฉ ฺฉู"
echo "   4. ูุชุงุฌ ุชุณุช ุฑู ุจุจู"
echo ""
echo "๐ ุจุฑุง ุชููู: pkill -f 'node.*simple-proxy' && pkill -f 'python3'"
echo ""
echo "๐ก ุงฺฏุฑ ูุดฺฉู ุฏุงุดุชุฏุ ุงู ุชุฑููุงู ุฑู ุจุงุฒ ูฺฏู ุฏุงุฑุฏ ู ุฎุทุงูุง ุฑู ฺฺฉ ฺฉูุฏ"
